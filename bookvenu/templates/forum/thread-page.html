<html>
<head>
    {% load staticfiles %}
    {% load material_form %}
    {% load widget_tweaks %}
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>BookVenue</title>
<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet">

    <!-- Bootstrap Core CSS -->
    <link href="{% static "css/bootstrap.min.css" %}" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="{% static "css/modern-business.css" %}" rel="stylesheet">
    <link href="{% static "css/styleinput.css" %}" rel="stylesheet">
    <!-- Custom Fonts -->
    <link href="{% static "font-awesome/css/font-awesome.min.css" %}" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="{% static "https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js" %}"></script>
        <script src="{% static "https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js" %}"></script>
    <![endif]-->    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <!-- Special version of Bootstrap that only affects content wrapped in .bootstrap-iso -->
    <link rel="stylesheet" href="{% static "https://formden.com/static/cdn/bootstrap-iso.css" %}" />

    <!--Font Awesome (added because you use icons in your prepend/append)-->
    <link rel="stylesheet" href="{% static "https://formden.com/static/cdn/font-awesome/4.4.0/css/font-awesome.min.css" %}" />
    <link rel="stylesheet" href="/maps/documentation/javascript/demos/demos.css">
    <style>
                            #img_size {
                                width: 845px;
                                margin: 0;
                                padding: 0;
                            }
                            @media only screen and (max-width: 599px){
                                #img_size {
                                    width: 287px;
                                    margin: 0;
                                    padding: 0;
                                }
                              }
                              @media only screen and (max-width: 770px and min-width:600px){
                                #img_size {
                                    width: 700px;
                                    margin: 0;
                                    padding: 0;
                                }
                              }

                              body{
                                background-color:#f2f2f2;
                              {

                                @media only screen and (max-width: 1700px){
                                #img_size {
                                    width: 287px;
                                    margin: 0;
                                    padding: 0;
                                }
                              }



                        </style>
        <link href="{% static "css/style.css" %}" rel="stylesheet">
    <link href="{% static "css/style-material.css" %}" rel="stylesheet">

</head>
<div>

   <div class="bv-header mdl-layout__header mdl-layout__header--waterfall">
        <div class="mdl-layout__header-row">
          <a href="/">
          <span class="bv-title mdl-layout-title">
            <img class="bv-logo-image" src='{% static "css/10.png" %}'>
          </span>
            </a>

          <!-- Add spacer, to align navigation to the right in desktop -->
          <div class="bv-header-spacer mdl-layout-spacer"></div>
          <div class="bv-search-box mdl-textfield mdl-js-textfield mdl-textfield--expandable mdl-textfield--floating-label mdl-textfield--align-right mdl-textfield--full-width">
            <div class="mdl-textfield__expandable-holder">
              <input class="mdl-textfield__input" type="text" id="search-field">
            </div>
          </div>
          <!-- Navigation -->
          <div class="bv-navigation-container">
            <nav class="bv-navigation mdl-navigation">
              <a class="mdl-navigation__link mdl-typography--text-uppercase" href="/create-request"><i class="material-icons">build</i> Create Request</a>
              <a class="mdl-navigation__link mdl-typography--text-uppercase" href="/create-post"><i class="material-icons">event</i> Add Event</a>
                <a class="mdl-navigation__link mdl-typography--text-uppercase" href="/profile"><i class="material-icons">face</i> Profile</a>
                <a class="mdl-navigation__link mdl-typography--text-uppercase" href="/logout"><i class="material-icons">lock</i> Logout</a>
                <a class="mdl-navigation__link mdl-typography--text-uppercase" href="/"><i class="material-icons">home</i> Home</a>
            </nav>
          </div>
        </div>
      </div>

</div>
    {% load staticfiles %}
    {% load material_form %}
    {% load widget_tweaks %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js%22%3E"</script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<div class="container">
    <div class="well">
<h3> {{ thread.name }} </h3>
        <hr>
<h4> {{ thread.body }} </h4>

</br>
{% if user == thread.user %}
  <a href='{{ thread.get_delete_url }}' class="btn btn-xs btn-danger"> Delete</a>
{% endif %}
    </div>
<a class='like-btn btn btn-xs btn-primary' data-href='{{ thread.get_like_url }}' data-likes='{{ thread.total_likes }}' href='{{ thread.get_like_url }}' ><span class="glyphicon glyphicon-thumbs-up"></span>{{ thread.total_likes }} Like</a>

{% for comment in comm_parent %}
                    <div class="row">
                        <div class="panel panel-default">
                        <div class="panel-heading">
                            <strong>{{ comment.user }}</strong> <span class="text-muted">{{ comment.date_created}}</span>
                        </div>

                        <div class="panel-body">
                            {{ comment.body }}
                        </div><!-- /panel-body -->
                        <a class='like-btn btn btn-xs btn-primary' data-href='{{ comment.get_like_url }}' data-likes='{{ comment.total_likes }}' href='{{ comment.get_like_url }}' ><span class="glyphicon glyphicon-thumbs-up"></span>{{ comment.total_likes }} Like</a>
      {% if comment.user == user %}
      <a href='{{comment.get_delete_url}}' class="btn btn-xs btn-danger"><span class="glyphicon glyphicon-minus-sign"></span> Delete comment</a>
        {% endif %}
                    </div><!-- /panel panel-default -->

                            {% for reply in comment.children %}

                        <div class="col-sm-10">
                            <div class="panel panel-comment panel-default">
                                <div class="panel-heading-comment panel-heading">
                                    <strong>{{ reply.user }}</strong> <span class="text-muted">{{ reply.date_created}}</span>
                                </div>
                                <div class="panel-body">
                                    {{ reply.body }}
                                </div><!-- /panel-body -->
                            </div><!-- /panel panel-default -->
                            <a class='like-btn btn btn-xs btn-primary' data-href='{{ reply.get_like_url }}' data-likes='{{ reply.total_likes }}' href='{{ reply.get_like_url }}' ><span class="glyphicon glyphicon-thumbs-up"></span>{{ reply.total_likes }} Like</a>
    {% if reply.user == user %}
    <a href='{{ reply.get_delete_url }}' class="btn btn-xs btn-danger"><span class="glyphicon glyphicon-minus-sign"></span> Delete comment</a>
      {% endif %}
                        </div><!-- /col-sm-5 -->
                        {% endfor %}



                            <form action="." method='post'>
                                {% csrf_token %}
                                <div class="col-lg-5">
                                <input type='hidden' name='parent_id' value={{comment.id}}>
                                <input class="form-control" name="body" value="{{form.body}}" type="text" placeholder="Your reply" />
                                    <button class="btn btn-success btn-circle text-uppercase" type="submit"><span class="glyphicon glyphicon-send"></span> Reply</button>
                                </div>
                            </form>
                    </div>
                            <br>
                    {% endfor %}

                        <div class="row">
                            <form action="." method='post'>
                                {% csrf_token %}
                                <div class="col-lg-9">
                                    <label class="col-sm-6 control-label">Post a comment </label>

                                        <input class="form-control" name="body" value="{{form.body}}"/>
                                        <div class="form-group">
                                            <button class="btn btn-success btn-circle text-uppercase" type="submit"><span class="glyphicon glyphicon-send"></span> Submit comment</button>
                                        </div>

                                </div>
                            </form>
                            <br>
                        </div>

                    </div>
</div>

<script>
     $(document).ready(function(){
          function updateText(btn, newCount, verb){
          btn.attr("data-likes", newCount)
          btn.text(newCount + " " + verb)
      }
      $(".like-btn").click(function(e){
        e.preventDefault()
        var this_ = $(this)
        var likeUrl = this_.attr("data-href")
        var likeCount = parseInt(this_.attr("data-likes")) | 0
        var addLike = likeCount + 1
        var removeLike = likeCount - 1
        var verb = "Likes"
        if( this.ajax ){
                    this.ajax.abort();
                }
        this.ajax = $.ajax({
            url: likeUrl,
            method: "GET",
            data: {},
            success: function(data){
              console.log(data)
              var newLikes;
              if (data.liked){
                  updateText(this_, addLike, verb)
              } else {
                  updateText(this_, removeLike, verb)
                  // remove one like
              }
            }, error: function(data){
              console.log(data)
              console.log("error")
            }
          })

      })
  })
    </script>
<div class="col-md-12">

                <footer class="bv-footer mdl-mega-footer">
          <div class="mdl-mega-footer--top-section">
            <div class="mdl-mega-footer--left-section">
              <button class="mdl-mega-footer--social-btn"><a href="https://www.facebook.com/temian.mihai"> <i class=" fa fa-facebook">   </i> </a></button>
              &nbsp;
              <button class="mdl-mega-footer--social-btn"><a href="https://www.facebook.com/temian.mihai"> <i class="fa fa-google-plus">   </i> </a></button>
              &nbsp;
              <button class="mdl-mega-footer--social-btn"><a href="https://www.facebook.com/temian.mihai"> <i class="fa fa-pinterest">   </i> </a></button>
            </div>
            <div class="mdl-mega-footer--right-section">
              <a class="mdl-typography--font-light" href="#top">
                Back to Top
                <i class="material-icons">expand_less</i>
              </a>
            </div>
          </div>

          <div class="mdl-mega-footer--middle-section">
            <p class="mdl-typography--font-light">Copyright © 2018 </p>
            <p class="mdl-typography--font-light">You can contact us writing us an mail at address:
                            <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="492420212820673d2c24202827092e24282025672a2624">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/javascript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script></p>
          </div>

          <div class="mdl-mega-footer--bottom-section">
            <a class="bv-link mdl-typography--font-light" href="/register">Signup</a>
            <a class="bv-link mdl-typography--font-light" href="/login">Login</a>
              <a class="bv-link mdl-typography--font-light" href="/forum">Forum</a>

          </div>

        </footer>

    </div>
</body>
</html>
